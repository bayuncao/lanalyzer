{
  "sources": [
    {
      "name": "UserInput",
      "patterns": ["input", "request.GET", "request.POST", "request.data", "request.form", "request.args", "request.json", "request.files", "request.cookies", "request.headers"]
    },
    {
      "name": "FileRead",
      "patterns": ["open", "read", "readlines", "readline", "file.read", "with open", "io.open", "*.open", "*.read*"]
    },
    {
      "name": "NetworkInput",
      "patterns": ["recv", "recvfrom", "recvmsg", "requests.get", "requests.post", "urllib.request.urlopen", "socket.recv", "http.client", "aiohttp", "httpx", "recv_rpc_message"]
    },
    {
      "name": "TorchDistributedInput",
      "patterns": ["all_gather", "all_gather_list", "broadcast", "broadcast_object", "broadcast_tensors", "dist.all_gather", "dist.broadcast", "torch.distributed.all_gather", "torch.distributed.broadcast"]
    },
    {
      "name": "TorchDistributedPickle",
      "patterns": ["pickle.loads", "pickle.dumps", "pickle.load", "pickle.dump", "io.BytesIO"]
    },
    {
      "name": "EnvironmentVariables",
      "patterns": ["os.environ", "os.getenv", "environ.get", "getenv"]
    },
    {
      "name": "CommandLineArgs",
      "patterns": ["sys.argv", "argparse", "ArgumentParser", "parse_args"]
    }
  ],
  "sinks": [
    {
      "name": "PickleDeserialization",
      "patterns": ["pickle.load", "pickle.loads", "cPickle.load", "cPickle.loads", "_pickle.load", "_pickle.loads"]
    },
    {
      "name": "TorchLoad",
      "patterns": ["torch.load", "torch.save", "torch.jit.load", "torch.jit.save", "model.load_state_dict"]
    },
    {
      "name": "TorchDistributedDeserialize",
      "patterns": ["all_gather_list", "_broadcast_object_slow", "broadcast_object"]
    }
  ],
  "sanitizers": [
    {
      "name": "TorchLimitedPickleSanitizer",
      "patterns": ["safe_load_state_dict", "torch.utils.model_zoo.load_url", "validate_pickle", "secure_pickle_load"]
    }
  ],
  "rules": [
    {
      "name": "TorchPickleDeserializationVulnerability",
      "sources": ["UserInput", "FileRead", "NetworkInput", "TorchDistributedInput", "EnvironmentVariables", "CommandLineArgs"],
      "sinks": ["PickleDeserialization", "TorchLoad", "TorchDistributedDeserialize"],
      "sanitizers": ["TorchLimitedPickleSanitizer"],
      "message": "发现潜在的PyTorch pickle反序列化漏洞。来自{source}的不受信任数据正在使用{sink}进行反序列化，这可能导致远程代码执行。请确保输入可信或使用更安全的序列化方法。"
    },
    {
      "name": "TorchDistributedPickleVulnerability",
      "sources": ["TorchDistributedInput", "TorchDistributedPickle"],
      "sinks": ["PickleDeserialization"],
      "message": "发现在PyTorch分布式计算中使用pickle进行反序列化的潜在风险。从{source}获取的数据正在使用{sink}进行不安全的反序列化，这可能导致恶意节点执行远程代码。在分布式训练中请确保所有节点都是可信的。"
    }
  ]
} 