{
  "sources": [
    {
      "name": "UserInput",
      "patterns": ["input(", "sys.argv", "request.args", "request.form"]
    },
    {
      "name": "FileRead",
      "patterns": ["open(", "read(", "readline(", "readlines("]
    },
    {
      "name": "NetworkInput",
      "patterns": ["recv(", "urlopen(", "get(", "post(", "request("]
    },
    {
      "name": "EnvironmentVariables",
      "patterns": ["os.environ", "os.getenv("]
    },
    {
      "name": "CommandLineArgs",
      "patterns": ["sys.argv", "argparse"]
    },
    {
      "name": "ConfigFiles",
      "patterns": ["config.get(", "ConfigParser", "json.load(", "yaml.load("]
    }
  ],
  "sinks": [
    {
      "name": "CodeExecution",
      "patterns": ["eval(", "exec(", "execfile("],
      "description": "Dynamic code execution functions that can execute arbitrary Python code"
    }
  ],
  "rules": [
    {
      "name": "UnsafeCodeExecution",
      "sources": ["UserInput", "FileRead", "NetworkInput", "EnvironmentVariables", "CommandLineArgs", "ConfigFiles"],
      "sinks": ["CodeExecution"],
      "message": "Potential unsafe code execution detected. Untrusted data from {source} is being used with {sink}, which could lead to arbitrary code execution."
    }
  ]
} 